<!-- Resource Index Section -->
<div id="team" class="section">
  <div class="fixed-wrapper">
    <h1>Resource Listing</h1>
  </div>
  <div class="container">
    <%= render "shared/error_messages" %>
    <div class="content">

      <div class="row" id="search">
        <div class = "col-lg-7 col-md-2 col-sm-2 col-xs-6">
        <%= form_tag resources_path, :method => 'get' do %>
          <%= text_field_tag :search, params[:search] %>
          <%= submit_tag "Search Resources  ", :name => nil %>
          <% if params[:search].present? %>
          	<% @resources %>
            <%= link_to "Clear Results", resources_path %>
          <% end %>
        <% end %>
        </div>
        <div class = "col-lg-3 col-md-2 col-sm-2 col-xs-6">
          <div class = "pagination">
            <%= will_paginate @resources, previous_label: h("<"), next_label: h(">")%>
          </div>
        </div>

      </div>

      <div class="resource-wall">

      </div>
    </div>          
  </div>
</div><!-- /.container -->

<div id="templates">
  <script class="resource" type="text/template">
    <div class="col-md-4 col-sm-4 col-xs-12">
      <div class="team-portrait block">              
        <div class="portrait">
          <a href="/resources/{{ id }}">
            <img class="resource-pic" src={{ picture }} />              
            <span class="overlay"><span class="valign"></span><i class="icon-search"></i></span>                    
          </a>
        </div>

        <div class="title">
          <div class="name"> 
            {{ name }}
          </div>
        </div>
        <div class="distance-away">
          <b>{{ distance }} miles away</b>
        </div>
      </div>
    </div>
  </script>
  
</div>

<% content_for :javascript do %>
  <script type="text/javascript">

    var wall = new ResourceWall([], {
      url: '/resources'
    });
    
    var wallView = new ResourceWallView({
      collection: wall,
      el: '.resource-wall'
    });

    <% @resources.each do |x| %>
      wall.add(<%= raw x.to_json({distance: @distances[x.user.id]}) %>);
    <% end %>
  </script>
<% end %>
